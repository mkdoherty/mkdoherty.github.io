\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{}
    \pretitle{\vspace{\droptitle}}
  \posttitle{}
    \author{}
    \preauthor{}\postauthor{}
    \date{}
    \predate{}\postdate{}
  

\begin{document}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# set random seed start for consistant results}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\CommentTok{# call data file}
\NormalTok{longformdata <-}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"201-107_DATAANALYSIS_longform_Rreadable.txt"}\NormalTok{, }
    \DataTypeTok{header =}\NormalTok{ T, }\DataTypeTok{sep =} \StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{)}
\CommentTok{# remove unneeded data fields for analysis}
\NormalTok{data <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(longformdata, }\DataTypeTok{select =} \KeywordTok{c}\NormalTok{(}\StringTok{"TxSamp"}\NormalTok{, }\StringTok{"Tx"}\NormalTok{, }\StringTok{"Matrix"}\NormalTok{, }
    \StringTok{"Time_hr"}\NormalTok{, }\StringTok{"analyte"}\NormalTok{, }\StringTok{"Conc_nM"}\NormalTok{))}
\CommentTok{# order levlels of analyte Pro>CDV>CDVPP for figure}
\CommentTok{# generation}
\NormalTok{data}\OperatorTok{$}\NormalTok{analyte <-}\StringTok{ }\KeywordTok{ordered}\NormalTok{(data}\OperatorTok{$}\NormalTok{analyte, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\StringTok{"Prodrug"}\NormalTok{, }\StringTok{"CDV"}\NormalTok{, }
    \StringTok{"PP"}\NormalTok{))}
\CommentTok{# rename the levels}
\KeywordTok{levels}\NormalTok{(data}\OperatorTok{$}\NormalTok{analyte) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Prodrug"}\NormalTok{, }\StringTok{"CDV"}\NormalTok{, }\StringTok{"CDV-PP"}\NormalTok{)}
\CommentTok{# order the test articles for figure generation}
\NormalTok{data}\OperatorTok{$}\NormalTok{Tx <-}\StringTok{ }\KeywordTok{ordered}\NormalTok{(data}\OperatorTok{$}\NormalTok{Tx, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\StringTok{"NPP669"}\NormalTok{, }\StringTok{"NPP666"}\NormalTok{, }\StringTok{"NPP663"}\NormalTok{, }
    \StringTok{"CDV"}\NormalTok{, }\StringTok{"CMX001"}\NormalTok{, }\StringTok{"USC505"}\NormalTok{))}
\CommentTok{# pull info from TxSamp column to indicate time collected and}
\CommentTok{# if sample is dose stability (ds), from medium (med), or}
\CommentTok{# from lysate (lys) and creates a new column 'SampleType'}
\NormalTok{data}\OperatorTok{$}\NormalTok{SampleType <-}\StringTok{ }\KeywordTok{gsub}\NormalTok{(}\StringTok{".*_(T}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w+)}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w+"}\NormalTok{, }\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{, data}\OperatorTok{$}\NormalTok{TxSamp)}
\CommentTok{# volume of lysate in mL}
\NormalTok{lysate_mL <-}\StringTok{ }\FloatTok{0.333}
\CommentTok{# volume of media in mL}
\NormalTok{media_mL <-}\StringTok{ }\DecValTok{10}

\CommentTok{# the following funtion converts nanomolar to nanomoles}
\NormalTok{Nanomol <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{    nmol <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(data}\OperatorTok{$}\NormalTok{Matrix }\OperatorTok{==}\StringTok{ "media"}\NormalTok{, (x}\OperatorTok{/}\DecValTok{1000} \OperatorTok{*}\StringTok{ }\NormalTok{media_mL), }
\NormalTok{        (x}\OperatorTok{/}\DecValTok{1000} \OperatorTok{*}\StringTok{ }\NormalTok{lysate_mL))}
    \KeywordTok{return}\NormalTok{(nmol)}
\NormalTok{\}}
\CommentTok{# use above function to convert concentration to raw}
\CommentTok{# nanomoles for each sample in a new column}
\NormalTok{data}\OperatorTok{$}\NormalTok{Nanomol <-}\StringTok{ }\KeywordTok{Nanomol}\NormalTok{(data}\OperatorTok{$}\NormalTok{Conc_nM)}
\CommentTok{# convert nanomoles to picomoles for each sample in a new}
\CommentTok{# column}
\NormalTok{data}\OperatorTok{$}\NormalTok{Picomol <-}\StringTok{ }\NormalTok{data}\OperatorTok{$}\NormalTok{Nanomol }\OperatorTok{*}\StringTok{ }\DecValTok{1000}

\CommentTok{# show structure of data and breakdowns by column}
\KeywordTok{summary}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              TxSamp         Tx        Matrix      Time_hr     
##  CDV_T0_ds1_CDV :  1   NPP669:27   lysate:51   Min.   : 0.00  
##  CDV_T0_ds2_CDV :  1   NPP666:27   media :90   1st Qu.:72.00  
##  CDV_T0_ds3_CDV :  1   NPP663:27               Median :72.00  
##  CDV_T72_ds1_CDV:  1   CDV   :15               Mean   :56.68  
##  CDV_T72_ds2_CDV:  1   CMX001:27               3rd Qu.:72.00  
##  CDV_T72_ds3_CDV:  1   USC505:18               Max.   :72.00  
##  (Other)        :135                                          
##     analyte      Conc_nM        SampleType           Nanomol      
##  Prodrug:51   Min.   :   0.0   Length:141         Min.   : 0.000  
##  CDV    :72   1st Qu.:   0.0   Class :character   1st Qu.: 0.000  
##  CDV-PP :18   Median : 387.6   Mode  :character   Median : 0.152  
##               Mean   : 558.6                      Mean   : 3.104  
##               3rd Qu.:1068.8                      3rd Qu.: 5.802  
##               Max.   :1784.5                      Max.   :13.463  
##                                                                   
##     Picomol     
##  Min.   :    0  
##  1st Qu.:    0  
##  Median :  152  
##  Mean   : 3104  
##  3rd Qu.: 5802  
##  Max.   :13463  
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# select all data with lysate as the matrix to determine}
\CommentTok{# analyte per cells}
\NormalTok{lysate <-}\StringTok{ }\NormalTok{data[data}\OperatorTok{$}\NormalTok{Matrix }\OperatorTok{==}\StringTok{ "lysate"}\NormalTok{, ]}
\CommentTok{# call in the cell count data}
\NormalTok{cellcountsdf <-}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"201-107_rawcellcounts.txt"}\NormalTok{, }\DataTypeTok{header =}\NormalTok{ T, }
    \DataTypeTok{sep =} \StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{)}

\CommentTok{# the following function coverts the raw hempocytometer}
\CommentTok{# counts to cells per flask}
\NormalTok{cells_per_flask <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(rawcells) \{}
\NormalTok{    cellsperflask <-}\StringTok{ }\NormalTok{rawcells}\OperatorTok{/}\DecValTok{4} \OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\DecValTok{10000} \OperatorTok{*}\StringTok{ }\DecValTok{5}
    \KeywordTok{return}\NormalTok{(cellsperflask)}
\NormalTok{\}}
\CommentTok{# use above function to add cells per flask column to cell}
\CommentTok{# count dataframe}
\NormalTok{cellcountsdf}\OperatorTok{$}\NormalTok{cellsperflask <-}\StringTok{ }\KeywordTok{cells_per_flask}\NormalTok{(cellcountsdf}\OperatorTok{$}\NormalTok{rawcells)}
\CommentTok{# calculate the mean cell count by treatment group as a new}
\CommentTok{# dataframe}
\NormalTok{avecellcounts <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(cellcountsdf }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(Tx) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{meancells =} \KeywordTok{mean}\NormalTok{(cellsperflask)))}
\CommentTok{# summary of cell count table}
\KeywordTok{summary}\NormalTok{(cellcountsdf)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Tx       rawcells      cellsperflask    
##  CDV   :3   Min.   : 50.00   Min.   :1250000  
##  CMX001:3   1st Qu.: 69.00   1st Qu.:1725000  
##  DMSO  :3   Median : 75.00   Median :1875000  
##  NPP663:3   Mean   : 81.24   Mean   :2030952  
##  NPP666:3   3rd Qu.: 95.00   3rd Qu.:2375000  
##  NPP669:3   Max.   :120.00   Max.   :3000000  
##  USC505:3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# average counts by group}
\NormalTok{avecellcounts}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Tx meancells
## 1    CDV   2583333
## 2 CMX001   1575000
## 3   DMSO   2375000
## 4 NPP663   2075000
## 5 NPP666   2250000
## 6 NPP669   1566667
## 7 USC505   1791667
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# combine the lysate data with average cell count data by}
\CommentTok{# group}
\NormalTok{lysate <-}\StringTok{ }\KeywordTok{merge}\NormalTok{(lysate, avecellcounts, }\DataTypeTok{by =} \StringTok{"Tx"}\NormalTok{)}
\CommentTok{# calculate picomole per 10^6 cells for each sample}
\NormalTok{lysate}\OperatorTok{$}\NormalTok{pmolPERmillCell <-}\StringTok{ }\NormalTok{lysate}\OperatorTok{$}\NormalTok{Picomol}\OperatorTok{/}\NormalTok{(lysate}\OperatorTok{$}\NormalTok{meancells}\OperatorTok{/}\FloatTok{1e+06}\NormalTok{)}

\CommentTok{# summary of lysate table}
\KeywordTok{summary}\NormalTok{(lysate)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Tx                 TxSamp      Matrix      Time_hr      analyte  
##  NPP669:9   CDV_T72_lys1_CDV: 1   lysate:51   Min.   :72   Prodrug:15  
##  NPP666:9   CDV_T72_lys1_PP : 1   media : 0   1st Qu.:72   CDV    :18  
##  NPP663:9   CDV_T72_lys2_CDV: 1               Median :72   CDV-PP :18  
##  CDV   :6   CDV_T72_lys2_PP : 1               Mean   :72               
##  CMX001:9   CDV_T72_lys3_CDV: 1               3rd Qu.:72               
##  USC505:9   CDV_T72_lys3_PP : 1               Max.   :72               
##             (Other)         :45                                        
##     Conc_nM        SampleType           Nanomol           Picomol      
##  Min.   :   0.0   Length:51          Min.   :0.00000   Min.   :  0.00  
##  1st Qu.: 282.0   Class :character   1st Qu.:0.09391   1st Qu.: 93.91  
##  Median : 449.5   Mode  :character   Median :0.14968   Median :149.68  
##  Mean   : 709.8                      Mean   :0.23636   Mean   :236.36  
##  3rd Qu.:1319.8                      3rd Qu.:0.43949   3rd Qu.:439.49  
##  Max.   :1784.5                      Max.   :0.59424   Max.   :594.24  
##                                                                        
##    meancells       pmolPERmillCell 
##  Min.   :1566667   Min.   :  0.00  
##  1st Qu.:1575000   1st Qu.: 53.35  
##  Median :1791667   Median : 84.83  
##  Mean   :1937745   Mean   :133.69  
##  3rd Qu.:2250000   3rd Qu.:204.68  
##  Max.   :2583333   Max.   :379.30  
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# calculate average picomoles per 10^6 cells by treatment}
\CommentTok{# group}
\NormalTok{avepmolpcell <-}\StringTok{ }\NormalTok{lysate }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(Tx, analyte) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{meanper =} \KeywordTok{mean}\NormalTok{(pmolPERmillCell), }
    \DataTypeTok{sd =}\NormalTok{ (}\KeywordTok{sd}\NormalTok{(pmolPERmillCell)))}
\CommentTok{# show average picomole per 10^6 cells by gorup}
\NormalTok{avepmolpcell}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 17 x 4
## # Groups:   Tx [?]
##    Tx     analyte meanper     sd
##    <ord>  <ord>     <dbl>  <dbl>
##  1 NPP669 Prodrug 314.    57.2  
##  2 NPP669 CDV     325.    35.9  
##  3 NPP669 CDV-PP  288.    13.9  
##  4 NPP666 Prodrug 132.     6.66 
##  5 NPP666 CDV     129.    22.3  
##  6 NPP666 CDV-PP  203.     3.13 
##  7 NPP663 Prodrug  47.9    6.25 
##  8 NPP663 CDV      37.1    5.84 
##  9 NPP663 CDV-PP   65.4    3.36 
## 10 CDV    CDV       0.434  0.752
## 11 CDV    CDV-PP    0      0    
## 12 CMX001 Prodrug 336.     4.09 
## 13 CMX001 CDV      69.5   18.0  
## 14 CMX001 CDV-PP   61.4    2.06 
## 15 USC505 Prodrug 113.    15.0  
## 16 USC505 CDV      69.3   16.8  
## 17 USC505 CDV-PP   80.9    2.75
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# isolate prodrug samples in lysate for statistical analysis}
\NormalTok{lys_pro <-}\StringTok{ }\NormalTok{lysate[lysate}\OperatorTok{$}\NormalTok{analyte }\OperatorTok{==}\StringTok{ "Prodrug"}\NormalTok{, ]}
\CommentTok{# isolate CDV samples in lysate for statistical analysis}
\NormalTok{lys_cdv <-}\StringTok{ }\NormalTok{lysate[lysate}\OperatorTok{$}\NormalTok{analyte }\OperatorTok{==}\StringTok{ "CDV"}\NormalTok{, ]}
\CommentTok{# isolate CDV-PP samples in lysate for statistical analysis}
\NormalTok{lys_pp <-}\StringTok{ }\NormalTok{lysate[lysate}\OperatorTok{$}\NormalTok{analyte }\OperatorTok{==}\StringTok{ "CDV-PP"}\NormalTok{, ]}

\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\CommentTok{# verify normal distribution}
\NormalTok{norm_pp <-}\StringTok{ }\KeywordTok{leveneTest}\NormalTok{(pmolPERmillCell }\OperatorTok{~}\StringTok{ }\NormalTok{Tx, lys_pp)}
\CommentTok{# perform anova comparing picomoles per 10^6 cells by}
\CommentTok{# treatment group}
\NormalTok{aov_pp <-}\StringTok{ }\KeywordTok{aov}\NormalTok{(pmolPERmillCell }\OperatorTok{~}\StringTok{ }\NormalTok{Tx, lys_pp)}
\CommentTok{# anova results table}
\KeywordTok{summary}\NormalTok{(aov_pp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Df Sum Sq Mean Sq F value   Pr(>F)    
## Tx           5 171988   34398   917.1 4.62e-15 ***
## Residuals   12    450      38                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# performs Tukey post-hoc test for multiple comparisions and}
\CommentTok{# adjusts p-values accordingly, same for the below anovas}
\NormalTok{mct_pp <-}\StringTok{ }\KeywordTok{TukeyHSD}\NormalTok{(aov_pp)}
\CommentTok{# display multiple comparison results}
\NormalTok{mct_pp}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = pmolPERmillCell ~ Tx, data = lys_pp)
## 
## $Tx
##                      diff         lwr        upr     p adj
## NPP666-NPP669  -84.752410 -101.548804  -67.95602 0.0000000
## NPP663-NPP669 -222.411192 -239.207586 -205.61480 0.0000000
## CDV-NPP669    -287.818277 -304.614670 -271.02188 0.0000000
## CMX001-NPP669 -226.433515 -243.229908 -209.63712 0.0000000
## USC505-NPP669 -206.888435 -223.684829 -190.09204 0.0000000
## NPP663-NPP666 -137.658782 -154.455176 -120.86239 0.0000000
## CDV-NPP666    -203.065867 -219.862260 -186.26947 0.0000000
## CMX001-NPP666 -141.681105 -158.477499 -124.88471 0.0000000
## USC505-NPP666 -122.136025 -138.932419 -105.33963 0.0000000
## CDV-NPP663     -65.407084  -82.203478  -48.61069 0.0000002
## CMX001-NPP663   -4.022322  -20.818716   12.77407 0.9612412
## USC505-NPP663   15.522758   -1.273636   32.31915 0.0763444
## CMX001-CDV      61.384762   44.588368   78.18116 0.0000004
## USC505-CDV      80.929842   64.133448   97.72624 0.0000000
## USC505-CMX001   19.545080    2.748686   36.34147 0.0197853
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# anova steps same as above but for CDV and Prodrug}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{norm_cdv <-}\StringTok{ }\KeywordTok{leveneTest}\NormalTok{(pmolPERmillCell }\OperatorTok{~}\StringTok{ }\NormalTok{Tx, lys_cdv)}
\NormalTok{aov_cdv <-}\StringTok{ }\KeywordTok{aov}\NormalTok{(pmolPERmillCell }\OperatorTok{~}\StringTok{ }\NormalTok{Tx, lys_cdv)}
\KeywordTok{summary}\NormalTok{(aov_cdv)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Df Sum Sq Mean Sq F value   Pr(>F)    
## Tx           5 201185   40237    99.5 2.43e-09 ***
## Residuals   12   4853     404                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mct_cdv <-}\StringTok{ }\KeywordTok{TukeyHSD}\NormalTok{(aov_cdv)}
\NormalTok{mct_cdv}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = pmolPERmillCell ~ Tx, data = lys_cdv)
## 
## $Tx
##                       diff        lwr         upr     p adj
## NPP666-NPP669 -195.9618667 -251.11258 -140.811156 0.0000006
## NPP663-NPP669 -287.9259759 -343.07669 -232.775265 0.0000000
## CDV-NPP669    -324.5740258 -379.72474 -269.423315 0.0000000
## CMX001-NPP669 -255.4620952 -310.61281 -200.311385 0.0000000
## USC505-NPP669 -255.7316093 -310.88232 -200.580899 0.0000000
## NPP663-NPP666  -91.9641092 -147.11482  -36.813399 0.0012511
## CDV-NPP666    -128.6121591 -183.76287  -73.461448 0.0000535
## CMX001-NPP666  -59.5002286 -114.65094   -4.349518 0.0320161
## USC505-NPP666  -59.7697426 -114.92045   -4.619032 0.0311408
## CDV-NPP663     -36.6480499  -91.79876   18.502661 0.2917495
## CMX001-NPP663   32.4638807  -22.68683   87.614591 0.4067818
## USC505-NPP663   32.1943666  -22.95634   87.345077 0.4150204
## CMX001-CDV      69.1119306   13.96122  124.262641 0.0119223
## USC505-CDV      68.8424165   13.69171  123.993127 0.0122555
## USC505-CMX001   -0.2695141  -55.42022   54.881197 1.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{norm_pro <-}\StringTok{ }\KeywordTok{leveneTest}\NormalTok{(pmolPERmillCell }\OperatorTok{~}\StringTok{ }\NormalTok{Tx, lys_pro)}
\NormalTok{aov_pro <-}\StringTok{ }\KeywordTok{aov}\NormalTok{(pmolPERmillCell }\OperatorTok{~}\StringTok{ }\NormalTok{Tx, lys_pro)}
\KeywordTok{summary}\NormalTok{(aov_pro)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Df Sum Sq Mean Sq F value   Pr(>F)    
## Tx           4 198439   49610   68.88 3.07e-07 ***
## Residuals   10   7202     720                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mct_pro <-}\StringTok{ }\KeywordTok{TukeyHSD}\NormalTok{(aov_pro)}
\NormalTok{mct_pro}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = pmolPERmillCell ~ Tx, data = lys_pro)
## 
## $Tx
##                     diff         lwr        upr     p adj
## NPP666-NPP669 -181.66717 -253.783338 -109.55099 0.0000656
## NPP663-NPP669 -266.20031 -338.316480 -194.08414 0.0000020
## CMX001-NPP669   22.04638  -50.069795   94.16255 0.8469444
## USC505-NPP669 -200.83179 -272.947961 -128.71562 0.0000270
## NPP663-NPP666  -84.53314 -156.649314  -12.41697 0.0207850
## CMX001-NPP666  203.71354  131.597371  275.82971 0.0000238
## USC505-NPP666  -19.16462  -91.280795   52.95155 0.8998891
## CMX001-NPP663  288.24669  216.130513  360.36286 0.0000010
## USC505-NPP663   65.36852   -6.747653  137.48469 0.0804850
## USC505-CMX001 -222.87817 -294.994338 -150.76199 0.0000105
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# figure building label columns for statistical comparisons}
\CommentTok{# from Tukey tests}
\NormalTok{stats_labs <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Tx =} \KeywordTok{factor}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"NPP669"}\NormalTok{, }\StringTok{"NPP666"}\NormalTok{, }
    \StringTok{"NPP663"}\NormalTok{, }\StringTok{"CDV"}\NormalTok{, }\StringTok{"CMX001"}\NormalTok{, }\StringTok{"USC505"}\NormalTok{), }\DecValTok{3}\NormalTok{)), }\DataTypeTok{analyte =} \KeywordTok{factor}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\StringTok{"Prodrug"}\NormalTok{, }
    \DecValTok{6}\NormalTok{), }\KeywordTok{rep}\NormalTok{(}\StringTok{"CDV"}\NormalTok{, }\DecValTok{6}\NormalTok{), }\KeywordTok{rep}\NormalTok{(}\StringTok{"CDV-PP"}\NormalTok{, }\DecValTok{6}\NormalTok{))), }\DataTypeTok{labs =} \KeywordTok{factor}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"bcf"}\NormalTok{, }
    \StringTok{"ace"}\NormalTok{, }\StringTok{"abe"}\NormalTok{, }\StringTok{"sdgsna"}\NormalTok{, }\StringTok{"bcf"}\NormalTok{, }\StringTok{"ae"}\NormalTok{, }\StringTok{"bcdef"}\NormalTok{, }\StringTok{"acdef"}\NormalTok{, }\StringTok{"ab"}\NormalTok{, }
    \StringTok{"abef"}\NormalTok{, }\StringTok{"abd"}\NormalTok{, }\StringTok{"abd"}\NormalTok{, }\StringTok{"bcdef"}\NormalTok{, }\StringTok{"acdef"}\NormalTok{, }\StringTok{"abd"}\NormalTok{, }\StringTok{"abcef"}\NormalTok{, }\StringTok{"abdf"}\NormalTok{, }
    \StringTok{"abde"}\NormalTok{)))}

\CommentTok{# annotate the column labels with letter for statistical}
\CommentTok{# comparisons}
\NormalTok{ann_text <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Tx =} \KeywordTok{factor}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"NPP669"}\NormalTok{, }\StringTok{"NPP666"}\NormalTok{, }\StringTok{"NPP663"}\NormalTok{, }
    \StringTok{"CDV"}\NormalTok{, }\StringTok{"CMX001"}\NormalTok{, }\StringTok{"USC505"}\NormalTok{)), }\DataTypeTok{labs =} \KeywordTok{factor}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"NPP-669}\CharTok{\textbackslash{}n}\StringTok{(a)"}\NormalTok{, }
    \StringTok{"NPP-666}\CharTok{\textbackslash{}n}\StringTok{(b)"}\NormalTok{, }\StringTok{"NPP-663}\CharTok{\textbackslash{}n}\StringTok{(c)"}\NormalTok{, }\StringTok{"CDV}\CharTok{\textbackslash{}n}\StringTok{(d)"}\NormalTok{, }\StringTok{"CMX-001}\CharTok{\textbackslash{}n}\StringTok{(e)"}\NormalTok{, }
    \StringTok{"USC-505}\CharTok{\textbackslash{}n}\StringTok{(f)"}\NormalTok{)))}

\CommentTok{# label CDV-Prodrug as 'na' since there isnt a prodrug}
\NormalTok{noCDVpro <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Tx =} \StringTok{"CDV"}\NormalTok{, }\DataTypeTok{analyte =} \StringTok{"Prodrug"}\NormalTok{, }\DataTypeTok{y =} \DecValTok{20}\NormalTok{, }
    \DataTypeTok{lab =} \StringTok{"italic(na)"}\NormalTok{)}

\CommentTok{# merge label datafram with avepmolcell dataframe for calling}
\CommentTok{# figure labels}
\NormalTok{labels <-}\StringTok{ }\KeywordTok{merge}\NormalTok{(stats_labs, avepmolpcell, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"Tx"}\NormalTok{, }\StringTok{"analyte"}\NormalTok{), }
    \DataTypeTok{all =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\CommentTok{# call color pallette package for figure}
\KeywordTok{library}\NormalTok{(RColorBrewer)}
\CommentTok{# select 3 complementary colors for 3 analytes from 'Pastel1'}
\CommentTok{# color pallette}
\NormalTok{myColors <-}\StringTok{ }\KeywordTok{brewer.pal}\NormalTok{(}\DecValTok{3}\NormalTok{, }\StringTok{"Pastel1"}\NormalTok{)}
\CommentTok{# assign a color to an analyte}
\KeywordTok{names}\NormalTok{(myColors) <-}\StringTok{ }\KeywordTok{levels}\NormalTok{(lysate}\OperatorTok{$}\NormalTok{analyte)}
\CommentTok{# instruct ggplot how to color columns}
\NormalTok{colScale <-}\StringTok{ }\KeywordTok{scale_fill_manual}\NormalTok{(}\DataTypeTok{name =} \StringTok{"analyte"}\NormalTok{, }\DataTypeTok{values =}\NormalTok{ myColors)}

\CommentTok{# figure building: ggplot calls data and variables to}
\CommentTok{# display, stat_summary selects bar chart display and}
\CommentTok{# errorbars using mean + SD, scale_x and geom_text add labels}
\CommentTok{# to x axis, scale_y does same for y axis, facet_grid breaks}
\CommentTok{# up figure by analyte and places the facet label on the}
\CommentTok{# left, geom_text labels CDV-Prodrug as na, colScale colors}
\CommentTok{# the columns and legend, theme_bw() instructs how figure}
\CommentTok{# background looks, remaining theme() calls remove the legend}
\CommentTok{# bolds the facet labels, titles the x axis and y axis}
\NormalTok{p <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(lysate, }\KeywordTok{aes}\NormalTok{(Tx, pmolPERmillCell, }\DataTypeTok{fill =}\NormalTok{ analyte)) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{stat_summary}\NormalTok{(}\DataTypeTok{geom =} \StringTok{"bar"}\NormalTok{, }\DataTypeTok{fun.y =}\NormalTok{ mean, }\DataTypeTok{position =} \StringTok{"dodge"}\NormalTok{, }
        \DataTypeTok{color =} \StringTok{"black"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{stat_summary}\NormalTok{(}\DataTypeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }\DataTypeTok{fun.ymin =} \ControlFlowTok{function}\NormalTok{(x) }\KeywordTok{mean}\NormalTok{(x) }\OperatorTok{-}\StringTok{ }
\StringTok{    }\KeywordTok{sd}\NormalTok{(x), }\DataTypeTok{fun.ymax =} \ControlFlowTok{function}\NormalTok{(x) }\KeywordTok{mean}\NormalTok{(x) }\OperatorTok{+}\StringTok{ }\KeywordTok{sd}\NormalTok{(x), }\DataTypeTok{position =} \StringTok{"dodge"}\NormalTok{, }
    \DataTypeTok{width =} \FloatTok{0.5}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{scale_x_discrete}\NormalTok{(}\DataTypeTok{breaks =}\NormalTok{ ann_text}\OperatorTok{$}\NormalTok{Tx, }\DataTypeTok{labels =}\NormalTok{ ann_text}\OperatorTok{$}\NormalTok{labs) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{geom_text}\NormalTok{(labels, }\DataTypeTok{mapping =} \KeywordTok{aes}\NormalTok{(Tx, }\DataTypeTok{y =}\NormalTok{ (meanper }\OperatorTok{+}\StringTok{ }\NormalTok{sd }\OperatorTok{+}\StringTok{ }\DecValTok{20}\NormalTok{), }
        \DataTypeTok{label =}\NormalTok{ labs)) }\OperatorTok{+}\StringTok{ }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{limits =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{425}\NormalTok{), }
    \DataTypeTok{expand =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)) }\OperatorTok{+}\StringTok{ }\KeywordTok{facet_grid}\NormalTok{(analyte }\OperatorTok{~}\StringTok{ }\NormalTok{., }\DataTypeTok{switch =} \StringTok{"both"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{geom_text}\NormalTok{(noCDVpro, }\DataTypeTok{mapping =} \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ Tx, }\DataTypeTok{y =}\NormalTok{ y, }\DataTypeTok{label =}\NormalTok{ lab), }
        \DataTypeTok{parse =}\NormalTok{ T) }\OperatorTok{+}\StringTok{ }\NormalTok{colScale }\OperatorTok{+}\StringTok{ }\KeywordTok{theme_bw}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{strip.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Treatment"}\NormalTok{, }
    \DataTypeTok{y =} \KeywordTok{bquote}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"Picomoles Analyte per 10"}\OperatorTok{^}\StringTok{"6"}\NormalTok{, }\StringTok{" HFF-1 cells"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}


\end{document}
